(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7205f9e7","chunk-32015855"],{"420a":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ns"},[a("div",{ref:"dom",staticClass:"container"}),a("div",{staticClass:"mode-list"},e._l(e.modeList,(function(t,r){return a("div",{key:r,staticClass:"item",class:{active:r==e.mode},on:{click:function(t){return e.toggle(r)}}},[e._v(e._s(t.name))])})),0)])},i=[],s=a("5996"),n=a("2650"),o=a("53f8"),c=a("6d1b"),l=a("a611"),y=a("f6ad"),b=a("4ae5"),u=new n["default"]({url:"".concat("","/arcgis/rest/services/yxt/yxt2020/MapServer"),title:'卫星影像["Transverse_Mercator"]',id:"gz-nswx",opacity:1}),p=new n["default"]({url:"".concat("","/arcgis/rest/services/dzdt/dzdt2000/MapServer"),title:'电子政务["Gauss_Kruger"]',id:"gz-ns",opacity:1}),d=new o["default"]({url:"".concat("","/arcgis/rest/services/konggui/%E6%8E%A7%E8%A7%84%E5%9C%B0%E5%9D%97%E5%AF%BC%E5%88%99202103%E8%B0%83%E6%95%B4%E7%89%B9%E5%AE%9A%E7%89%88/MapServer"),title:"控规地块导则202103调整特定版",id:"gz-kg",opacity:.8,visible:!0}),h=new s["a"]({wkt:'PROJCS["GUANGZHOU2000",GEOGCS["GCS_China_Geodetic_Coordinate_System_2000",DATUM["D_China_2000",SPHEROID["CGCS2000",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["false_easting",0.0],PARAMETER["false_northing",0.0],PARAMETER["central_meridian",113.28],PARAMETER["scale_factor",1.0],PARAMETER["latitude_of_origin",0.0],UNIT["Meter",1.0]]'}),m=new s["a"]({wkt:'PROJCS["GUANGZHOU2000",GEOGCS["GCS_China_Geodetic_Coordinate_System_2000",DATUM["D_China_2000",SPHEROID["CGCS2000",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Gauss_Kruger"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",113.28],PARAMETER["Scale_Factor",1.0],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]]'}),O={name:"NS",components:{},data:function(){return{map:null,view:null,modeList:[{name:"影像+控规",sp:h,layers:[u,d]},{name:"政务+控规",sp:m,layers:[p,d]}]}},computed:{mode:function(){return 1==this.$route.query.mode?1:0}},mounted:function(){this.init()},methods:{init:function(){var e=this.modeList[this.mode],t=e.sp,a=e.layers;this.map=new c["a"]({layers:a}),this.view=new l["a"]({map:this.map,container:this.$refs["dom"],center:new b["a"]({x:54810.07389911926,y:192729.84924644174,spatialReference:t}),zoom:2,background:{color:"#0d293e"}});var r=new y["a"]({view:this.view});this.view.ui.add(r,{position:"bottom-left"})},toggle:function(){var e=1==this.mode?0:1;this.$router.push({path:"/ns",query:{mode:e}}),location.reload()}}},g=O,f=(a("c437"),a("2877")),j=Object(f["a"])(g,r,i,!1,null,null,null);t["default"]=j.exports},"49a0":function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a("8048");const i=96;function s(e,t){const a=t||e.extent,s=e.width,n=Object(r["d"])(a&&a.spatialReference);return a&&s?a.width/s*n*r["h"]*i:0}},"53f8":function(e,t,a){"use strict";a.r(t);var r=a("a4ee"),i=(a("c120"),a("b2b2")),s=(a("e92d"),a("cea0")),n=a("59b2"),o=a("afcf"),c=a("d386"),l=a("09db"),y=a("ce50"),b=(a("e041"),a("8eed"),a("92ef")),u=(a("f402"),a("f4cc")),p=a("3af1"),d=a("2eab"),h=a("1853"),m=a("a6a3"),O=a("658b"),g=a("e694"),f=a("22f4"),j=a("b911"),v=a("3d59"),S=a("997b"),E=a("8b28"),w=a("0db5"),x=a("8e17"),_=a("5a62"),R=a("601a"),P=a("9096"),M=a("49a0"),A=a("303f"),L=a("e9d0"),T=a("2258"),C=a("d409"),D=a("70ce");let N=class extends(Object(S["a"])(Object(R["a"])(Object(_["a"])(Object(x["a"])(Object(C["a"])(Object(A["a"])(Object(v["a"])(Object(j["a"])(Object(w["a"])(Object(g["a"])(Object(E["a"])(Object(P["b"])(m["a"]))))))))))))){constructor(...e){super(...e),this.alwaysRefetch=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=Object(i["k"])(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then(()=>this._fetchService(t),()=>this._fetchService(t))),Promise.resolve(this)}readImageFormat(e,t){const a=t.supportedImageFormatTypes;return a&&a.indexOf("PNG32")>-1?"png32":"png24"}writeSublayers(e,t,a,r){if(!this.loaded||!e)return;const i=e.slice().reverse().flatten(({sublayers:e})=>e&&e.toArray().reverse()).toArray();let s=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){const e=Object(b["d"])(r.origin);if(3===e){const e=this.createSublayersForOrigin("service").sublayers;s=Object(T["c"])(i,e,2)}else if(e>3){const e=this.createSublayersForOrigin("portal-item");s=Object(T["c"])(i,e.sublayers,Object(b["d"])(e.origin))}}const n=[],o={writeSublayerStructure:s,...r};let c=s;i.forEach(e=>{const t=e.write({},o);n.push(t),c=c||"user"===e.originOf("visible")}),n.some(e=>Object.keys(e).length>1)&&(t.layers=n),c&&(t.visibleLayers=i.filter(e=>e.visible).map(e=>e.id))}createExportImageParameters(e,t,a,r){const i=r&&r.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());const s=new D["a"]({layer:this,scale:Object(M["a"])({extent:e,width:t})*i}),n=s.toJSON();s.destroy();const o=!r||!r.rotation||this.version<10.3?{}:{rotation:-r.rotation},c=e&&e.spatialReference,l=c.wkid||JSON.stringify(c.toJSON());n.dpi*=i;const y={};if(null!=r&&r.timeExtent){const{start:e,end:t}=r.timeExtent.toJSON();y.time=e&&t&&e===t?""+e:`${null==e?"null":e},${null==t?"null":t}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(y.time="null,null");return{bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:l,imageSR:l,size:t+","+a,...n,...o,...y}}async fetchImage(e,t,a,r){const i={responseType:"image"};r&&r.timestamp&&(i.query={...i.query,_ts:r.timestamp}),r&&r.signal&&(i.signal=r.signal),this.customParameters&&Object.keys(this.customParameters).length&&(i.query={...this.customParameters,...i.query});const s=this.parsedUrl.path+"/export",n={...this.parsedUrl.query,...this.createExportImageParameters(e,t,a,r),f:"image",_ts:this.alwaysRefetch?Date.now():null};return null==n.dynamicLayers||this.capabilities.exportMap.supportsDynamicLayers?(i.query?i.query={...n,...i.query}:i.query=n,Object(d["default"])(s,i).then(e=>e.data).catch(e=>{if(Object(u["m"])(e))throw e;throw new y["a"]("mapimagelayer:image-fetch-error","Unable to load image: "+s,{error:e})})):Promise.reject(new y["a"]("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:n}))}async fetchRecomputedExtents(e={}){const t={...e,query:{returnUpdates:!0,f:"json"}},{data:a}=await Object(d["default"])(this.url,t),{extent:r,fullExtent:i,timeExtent:s}=a,n=r||i;return{fullExtent:n&&p["a"].fromJSON(n),timeExtent:s&&O["a"].fromJSON({start:s[0],end:s[1]})}}loadAll(){return Object(h["a"])(this,e=>{e(this.allSublayers)})}async _fetchService(e){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});const{data:t,ssl:a}=await Object(d["default"])(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters},signal:e});a&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=t,this.read(t,{origin:"service",url:this.parsedUrl})}};Object(r["a"])([Object(n["b"])()],N.prototype,"alwaysRefetch",void 0),Object(r["a"])([Object(n["b"])()],N.prototype,"dpi",void 0),Object(r["a"])([Object(n["b"])()],N.prototype,"gdbVersion",void 0),Object(r["a"])([Object(n["b"])()],N.prototype,"imageFormat",void 0),Object(r["a"])([Object(o["a"])("imageFormat",["supportedImageFormatTypes"])],N.prototype,"readImageFormat",null),Object(r["a"])([Object(n["b"])({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],N.prototype,"imageMaxHeight",void 0),Object(r["a"])([Object(n["b"])({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],N.prototype,"imageMaxWidth",void 0),Object(r["a"])([Object(n["b"])()],N.prototype,"imageTransparency",void 0),Object(r["a"])([Object(n["b"])({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N.prototype,"isReference",void 0),Object(r["a"])([Object(n["b"])({json:{read:!1,write:!1}})],N.prototype,"labelsVisible",void 0),Object(r["a"])([Object(n["b"])({type:["ArcGISMapServiceLayer"]})],N.prototype,"operationalLayerType",void 0),Object(r["a"])([Object(n["b"])({json:{read:!1,write:!1}})],N.prototype,"popupEnabled",void 0),Object(r["a"])([Object(n["b"])()],N.prototype,"sourceJSON",void 0),Object(r["a"])([Object(n["b"])({json:{write:{ignoreOrigin:!0}}})],N.prototype,"sublayers",void 0),Object(r["a"])([Object(l["a"])("sublayers",{layers:{type:[L["a"]]},visibleLayers:{type:[s["a"]]}})],N.prototype,"writeSublayers",null),Object(r["a"])([Object(n["b"])({type:["show","hide","hide-children"]})],N.prototype,"listMode",void 0),Object(r["a"])([Object(n["b"])({json:{read:!1},readOnly:!0,value:"map-image"})],N.prototype,"type",void 0),Object(r["a"])([Object(n["b"])(f["n"])],N.prototype,"url",void 0),N=Object(r["a"])([Object(c["a"])("esri.layers.MapImageLayer")],N);var I=N;t["default"]=I},"5b09":function(e,t,a){},"70ce":function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var r=a("a4ee"),i=(a("c120"),a("e92d"),a("cea0"),a("59b2")),s=a("d386"),n=(a("e041"),a("8eed"),a("f402"),a("fc29")),o=a("22f4"),c=a("9096"),l=a("2258");const y={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let b=class extends(Object(c["b"])(n["a"])){constructor(e){super(e),this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map(e=>e.toExportImageJSON());return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&Object(l["a"])(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("sublayer-update",e=>this.notifyChange(y[e.propertyName]))],"layer"))}get layers(){const e=this.visibleSublayers;return e?e.length?"show:"+e.map(e=>e.id).join(","):"show:-1":null}get layerDefs(){const e=this.visibleSublayers.filter(e=>null!=e.definitionExpression);return e.length?JSON.stringify(e.reduce((e,t)=>(e[t.id]=t.definitionExpression,e),{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const e=this.layer;return e&&(e.commitProperty("dpi"),e.commitProperty("imageFormat"),e.commitProperty("imageTransparency"),e.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const e=[];if(!this.layer)return e;const t=this.layer.sublayers,a=t=>{const r=this.scale,i=0===r,s=0===t.minScale||r<=t.minScale,n=0===t.maxScale||r>=t.maxScale;t.visible&&(i||s&&n)&&(t.sublayers?t.sublayers.forEach(a):e.unshift(t))};t&&t.forEach(a);const r=this._get("visibleSublayers");return!r||r.length!==e.length||r.some((t,a)=>e[a]!==t)?e:r}toJSON(){const e=this.layer;let t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t={...t,layers:this.layers,layerDefs:this.layerDefs},t}};Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"dynamicLayers",null),Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"hasDynamicLayers",null),Object(r["a"])([Object(i["b"])()],b.prototype,"layer",null),Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"layers",null),Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"layerDefs",null),Object(r["a"])([Object(i["b"])({type:Number})],b.prototype,"scale",void 0),Object(r["a"])([Object(i["b"])(o["a"])],b.prototype,"timeExtent",void 0),Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"version",null),Object(r["a"])([Object(i["b"])({readOnly:!0})],b.prototype,"visibleSublayers",null),b=Object(r["a"])([Object(s["a"])("esri.layers.mixins.ExportImageParameters")],b)},c437:function(e,t,a){"use strict";a("5b09")}}]);