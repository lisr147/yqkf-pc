(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13156232"],{"1b4a":function(t,e,n){"use strict";n.d(e,"a",(function(){return M}));var r=n("3349"),i=n("a29a"),s=n("2c63"),a=n("738e"),o=n("32dd"),l=n("d114"),c=n("a9c0"),u=n("38a4");class f{constructor(t,e,n,r){this.center=Object(a["b"])(t,e),this.centerT=Object(a["a"])(),this.halfWidth=n/2,this.halfHeight=r/2,this.width=n,this.height=r}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t}set y(t){this.center[1]=t}clone(){return new f(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t,e=4){const n=Math.abs(t.centerT[0]-this.centerT[0]),r=Math.abs(t.centerT[1]-this.centerT[1]),i=(t.halfWidth+this.halfWidth+e)/n,s=(t.halfHeight+this.halfHeight+e)/r,a=Math.min(i,s);return Object(u["j"])(a)}extend(t){const e=Math.min(this.xmin,t.xmin),n=Math.min(this.ymin,t.ymin),r=Math.max(this.xmax,t.xmax)-e,i=Math.max(this.ymax,t.ymax)-n,s=e+r/2,a=n+i/2;this.width=r,this.height=i,this.halfWidth=r/2,this.halfHeight=i/2,this.x=s,this.y=a}static deserialize(t){const e=t.readF32(),n=t.readF32(),r=t.readInt32(),i=t.readInt32();return new f(e,n,r,i)}}var h=f;const d=26,b=4,p=d+b,m=d-6,g=3,y=8,x=Math.PI/180;class O{constructor(t,e,n,r){this._rotationT=Object(s["a"])(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const i=n.rect,a=new Float32Array(8);t*=r,e*=r;const o=n.code?i.width*r:n.metrics.width,l=n.code?i.height*r:n.metrics.height;a[0]=t,a[1]=e,a[2]=t+o,a[3]=e,a[4]=t,a[5]=e+l,a[6]=t+o,a[7]=e+l,this._data=a,this._setTextureCoords(i),this._scale=r,this._mosaic=n,this.x=t,this.y=e,this.maxOffset=Math.max(t+o,e+l)}get width(){return this._mosaic.metrics.width*this._scale}get mosaic(){return this._mosaic}set angle(t){this._angle=t,Object(i["d"])(this._rotationT),Object(i["f"])(this._rotationT,this._rotationT,-t),this._setOffsets(this._data)}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:e}=this._mosaic.metrics,n=e*this._scale,r=Math.abs(t)*this._scale,a=new Float32Array(8);a[0]=this.x,a[1]=this.y,a[2]=this.x+n,a[3]=this.y,a[4]=this.x,a[5]=this.y+r,a[6]=this.x+n,a[7]=this.y+r;const o=Object(i["e"])(Object(s["a"])(),this._rotationT,this._T);Object(s["b"])(a,a,o);let l=1/0,c=1/0,u=0,f=0;for(let i=0;i<4;i++){const t=a[2*i],e=a[2*i+1];l=Math.min(l,t),c=Math.min(c,e),u=Math.max(u,t),f=Math.max(f,e)}const d=u-l,b=f-c,p=l+d/2,m=c+b/2;this._bounds=new h(p,m,d,b)}return this._bounds}setTransform(t){this._T=t,this._offsets=null}_setOffsets(t){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const e=this._offsets,n=new Float32Array(8),r=Object(i["e"])(Object(s["a"])(),this._rotationT,this._T);Object(s["b"])(n,t,r),e.upperLeft=Object(l["a"])(n[0]*y,n[1]*y),e.upperRight=Object(l["a"])(n[2]*y,n[3]*y),e.lowerLeft=Object(l["a"])(n[4]*y,n[5]*y),e.lowerRight=Object(l["a"])(n[6]*y,n[7]*y)}_setTextureCoords({x:t,y:e,width:n,height:r}){this._texcoords={upperLeft:Object(l["a"])(t,e),upperRight:Object(l["a"])(t+n,e),lowerLeft:Object(l["a"])(t,e+r),lowerRight:Object(l["a"])(t+n,e+r)}}}const j=(t,e)=>({code:0,page:0,sdf:!0,rect:new c["a"](0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}});class v{constructor(t,e,n){this._rotation=0,this._decorate(t,e,n),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=e.length>1,this._hasRotation=0!==n.angle,this._T=this._createGlyphTransform(this.bounds,n);for(const r of t)r.setTransform(this._T)}setRotation(t){if(0===t&&0===this._rotation)return;this._rotation=t;const e=this._T,n=Object(i["b"])(Object(s["a"])(),t);Object(i["e"])(e,n,e);for(const r of this.glyphs)r.setTransform(this._T)}_decorate(t,e,n){if(!n.decoration||"none"===n.decoration||!t.length)return;const r=n.scale,i="underline"===n.decoration?p:m,s=t[0].textureBinding;for(const a of e){const e=a.startX*r,n=a.startY*r,o=(a.width+a.glyphWidthEnd)*r;t.push(new O(e,n+i*r,j(o,s),1))}}get boundsT(){const t=this.bounds,e=Object(r["r"])(Object(a["a"])(),t.x,t.y);if(Object(r["s"])(e,e,this._T),this._hasRotation){const n=Math.max(t.width,t.height);return new h(e[0],e[1],n,n)}return new h(e[0],e[1],t.width,t.height)}_createBounds(t){let e=1/0,n=1/0,r=0,i=0;for(const o of t)e=Math.min(e,o.xTopLeft),n=Math.min(n,o.yTopLeft),r=Math.max(r,o.xTopLeft+o.width),i=Math.max(i,o.yBottomRight);const s=r-e,a=i-n;return new h(e+s/2,n+a/2,s,a)}_createGlyphTransform(t,e){const n=x*e.angle,o=Object(s["a"])(),l=Object(a["a"])();return Object(i["h"])(o,o,Object(r["r"])(l,e.xOffset,-e.yOffset)),e.isCIM?Object(i["f"])(o,o,n):(Object(i["h"])(o,o,Object(r["r"])(l,t.x,t.y)),Object(i["f"])(o,o,n),Object(i["h"])(o,o,Object(r["r"])(l,-t.x,-t.y))),o}}class w{constructor(t,e,n,r,i,s){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(e,n)),this.end=Math.max(0,Math.max(e,n)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=r,this.yMin=i,this.yMax=s}}const T=t=>10===t,S=t=>32===t;function _(t,e,n){const r=new Array,i=1/n.scale,s=n.maxLineWidth*i,a=e?t.length-1:0,o=e?-1:t.length,l=e?-1:1;let c=a,u=0,f=0,h=c,d=h,b=0,p=1/0,m=0;for(;c!==o;){const{code:e,metrics:n}=t[c],i=Math.abs(n.top);if(T(e)||S(e)||(p=Math.min(p,i),m=Math.max(m,i+n.height)),T(e))c!==a&&(r.push(new w(t,h,c-l,u,p,m)),p=1/0,m=0),u=0,h=c+l,d=c+l,f=0;else if(S(e))d=c+l,f=0,b=n.advance,u+=n.advance;else if(u>s){if(d!==h){const e=d-2*l;u-=b,r.push(new w(t,h,e,u-f,p,m)),p=1/0,m=0,h=d,u=f}else r.push(new w(t,h,c-l,u,p,m)),p=1/0,m=0,h=c,d=c,u=0;u+=n.advance,f+=n.advance}else u+=n.advance,f+=n.advance;c+=l}const g=new w(t,h,c-l,u,p,m);return g.start>=0&&g.end<t.length&&r.push(g),r}function L(t,e){let n=0;for(let s=0;s<t.length;s++){const{width:e}=t[s];n=Math.max(e,n)}const r="underline"===e.decoration?b:0,i=t[0].yMin;return{x:0,y:i,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+r-i,width:n}}function M(t,e,n){const r=n.scale,i=new Array,s=_(t,e,n),a=L(s,n),{vAlign:l,hAlign:c}=n,u=l===o["a"].Baseline?1:0,f=u?0:l-1,h=(1-u)*-a.y+f*(a.height/2)+(u?1:0)*-d;for(let o=0;o<s.length;o++){const{start:e,end:a,width:l}=s[o];let u=-1*(c+1)*(l/2)-g;const f=o*n.lineHeight+h-g;s[o].startX=u,s[o].startY=f;for(let n=e;n<=a;n++){const e=t[n];if(T(e.code))continue;const s=new O(u+e.metrics.left,f-e.metrics.top,e,r);u+=e.metrics.advance,i.push(s)}}return new v(i,s,n)}},"32dd":function(t,e,n){"use strict";var r,i;function s(t){switch(t){case"left":return r.Left;case"right":return r.Right;case"center":case"justify":return r.Center}}function a(t){switch(t){case"top":return i.Top;case"middle":return i.Center;case"baseline":return i.Baseline;case"bottom":return i.Bottom}}function o(t){switch(t){case"above-left":return[r.Right,i.Bottom];case"above-center":case"above-along":return[r.Center,i.Bottom];case"above-right":return[r.Left,i.Bottom];case"center-left":return[r.Right,i.Center];case"center-center":case"center-along":return[r.Center,i.Center];case"center-right":return[r.Left,i.Center];case"below-left":return[r.Right,i.Top];case"below-center":case"below-along":return[r.Center,i.Top];case"below-right":return[r.Left,i.Top];case"always-horizontal":return[r.Center,i.Baseline];default:return console.debug("Found invalid placement type "+t),[r.Center,i.Center]}}function l(t){switch(t){case r.Right:return-1;case r.Center:return 0;case r.Left:return 1;default:return console.debug("Found invalid horizontal alignment "+t),0}}function c(t){switch(t){case i.Top:return 1;case i.Center:return 0;case i.Bottom:case i.Baseline:return-1;default:return console.debug("Found invalid vertical alignment "+t),0}}function u(t){switch(t){case"left":return r.Left;case"right":return r.Right;case"center":case"justify":return r.Center}}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"f",(function(){return a})),n.d(e,"g",(function(){return c})),function(t){t[t.Left=-1]="Left",t[t.Center=0]="Center",t[t.Right=1]="Right"}(r||(r={})),function(t){t[t.Top=1]="Top",t[t.Center=0]="Center",t[t.Bottom=-1]="Bottom",t[t.Baseline=2]="Baseline"}(i||(i={}))},"334f":function(t,e,n){"use strict";n.d(e,"a",(function(){return T})),n.d(e,"b",(function(){return w})),n.d(e,"c",(function(){return _})),n.d(e,"d",(function(){return U})),n.d(e,"e",(function(){return N})),n.d(e,"f",(function(){return k})),n.d(e,"g",(function(){return W})),n.d(e,"h",(function(){return F})),n.d(e,"i",(function(){return S})),n.d(e,"j",(function(){return M})),n.d(e,"k",(function(){return I})),n.d(e,"l",(function(){return L}));n("c120");var r=n("b2b2"),i=n("7f83"),s=n("28b1"),a=n("a9ab"),o=n("a915"),l=n("9180"),c=n("f70f"),u=n("a8d5"),f=n("3349"),h=n("a29a"),d=n("2c63"),b=n("738e"),p=n("32dd"),m=n("1b4a"),g=n("b7b9"),y=n("793f");const x=Math.PI/180,O=.04,j=Object(d["a"])(),v=Object(b["a"])(),w=512,T=50;function S(t,e){if(!e.isWrappable)return null;const[n,r]=Object(c["c"])(e);return t[2]>r?[Object(l["g"])([t[0],t[1],r,t[3]]),Object(l["g"])([n,t[1],n+t[2]-r,t[3]])]:t[0]<n?[Object(l["g"])([n,t[1],t[2],t[3]]),Object(l["g"])([r-(n-t[0]),t[1],r,t[3]])]:null}function _(t,e,n,r,i,o,l){if(!r||!n.symbol)return t[0]=t[1]=t[2]=t[3]=0,e[0]=e[1]=e[2]=e[3]=0,t;const c=r;if(!Object(a["f"])(c)){Object(s["a"])(t,c);let r=e[0];0===r&&(r=P(n),e[0]=r);const a=i*r/2;return t[0]-=a,t[1]-=a,t[2]+=a,t[3]+=a,t}{const r=c.x,s=c.y;"esriTS"===n.symbol.type&&0===e[2]&&0===e[3]&&W(e,n.symbol,n.mosaicItem),D(t,r,s,n.symbol,e,i,o,l)}return t}function L(t){return"text"===t||"esriTS"===t}function M(t){return"simple-marker"===t||"picture-marker"===t||"esriSMS"===t||"esriPMS"===t}function F(t){switch(Object(r["q"])(t.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}const A=Object(b["a"])(),R=Object(b["a"])(),B=Object(b["a"])(),z=Object(b["a"])(),E=Object(b["a"])(),V=Object(b["a"])(),C=Object(b["a"])();function I(t,e,n,r){Object(f["r"])(B,e,n);const i=t.paths;let s,a,o,l,c,u,h,d,b,p=1/0;for(let m=0;m<i.length;m++){const t=i[m];if(!(t.length<2))for(let i=1;i<t.length;i++)s=t[i-1][0],o=t[i-1][1],a=t[i][0],l=t[i][1],c=Math.min(s,a)-r,u=Math.min(o,l)-r,h=Math.max(s,a)+r,d=Math.max(o,l)+r,e<c||e>h||n<u||n>d||(Object(f["r"])(A,s,o),Object(f["r"])(R,a,l),Object(f["d"])(z,R,A),Object(f["d"])(E,A,B),Object(f["a"])(V,z,Object(f["g"])(z,E)/Object(f["g"])(z,z)),Object(f["d"])(C,E,V),b=Object(f["g"])(C,C),p>b&&(p=b))}return Math.sqrt(p)<=r}function N(t,e,n,r,i,s){let a,l;const c=Object(o["g"])(n.xoffset),u=Object(o["g"])(n.yoffset),d=x*n.angle,b=x*s;switch(n.type){case"esriSMS":a=l=Object(o["g"])(n.size);break;case"esriPMS":a=Object(o["g"])(n.width),l=Object(o["g"])(n.height)}i<O&&(r=O*r/i);const p=Object(h["d"])(j);Object(h["h"])(p,p,Object(f["r"])(v,t,e)),Object(h["f"])(p,p,b-d),Object(h["g"])(p,p,Object(f["r"])(v,r,-r)),Object(h["h"])(p,p,Object(f["r"])(v,c,-u));const m=[0,0];Object(f["s"])(m,Object(f["r"])(v,-.5*a,-.5*l),p);const g=[0,0];Object(f["s"])(g,Object(f["r"])(v,-.5*a,.5*l),p);const y=[0,0];Object(f["s"])(y,Object(f["r"])(v,.5*a,-.5*l),p);const w=[0,0];return Object(f["s"])(w,Object(f["r"])(v,.5*a,.5*l),p),{rings:[[m,y,w,g,m]]}}function U(t,e,n,r,i,s){const a=y["a"].getEnvelope(n.data);if(!a)return null;i<O&&(r=O*r/i);const l=Object(o["g"])(a.width),c=Object(o["g"])(a.height),u=Object(o["g"])(a.x),d=Object(o["g"])(a.y),b=0*x,p=x*s,m=Object(h["d"])(j);Object(h["h"])(m,m,Object(f["r"])(v,t,e)),Object(h["f"])(m,m,p-b),Object(h["g"])(m,m,Object(f["r"])(v,r,r));const g=[0,0];Object(f["s"])(g,Object(f["r"])(v,u,d+c),m);const w=[0,0];Object(f["s"])(w,Object(f["r"])(v,u,d),m);const T=[0,0];Object(f["s"])(T,Object(f["r"])(v,u+l,d+c),m);const S=[0,0];return Object(f["s"])(S,Object(f["r"])(v,u+l,d),m),{rings:[[g,T,S,w,g]]}}function k(t,e,n,r,i,s){const a=Object(o["g"])(n.xoffset),l=Object(o["g"])(n.yoffset),c=x*n.angle,u=x*s,d=Object(h["d"])(j);Object(h["h"])(d,d,Object(f["r"])(v,t,e)),Object(h["f"])(d,d,u),Object(h["g"])(d,d,Object(f["r"])(v,i,-i));const b=r[0]+r[2]/2,p=r[1]+r[3]/2;Object(h["h"])(d,d,Object(f["r"])(v,a,-l)),Object(h["h"])(d,d,Object(f["r"])(v,b,p)),Object(h["f"])(d,d,c),Object(h["h"])(d,d,Object(f["r"])(v,-b,-p));const m=[0,0];Object(f["s"])(m,Object(f["r"])(v,r[0],r[1]),d);const g=[0,0];Object(f["s"])(g,Object(f["r"])(v,r[0],r[1]+r[3]),d);const y=[0,0];Object(f["s"])(y,Object(f["r"])(v,r[0]+r[2],r[1]),d);const O=[0,0];return Object(f["s"])(O,Object(f["r"])(v,r[0]+r[2],r[1]+r[3]),d),{rings:[[m,y,O,g,m]]}}function P(t){switch(t.symbol.type){case"esriSFS":case"esriPFS":{const e=t.symbol.outline;return e?e.width:0}case"esriSLS":return Object(o["g"])(t.symbol.width);case"esriSMS":return Object(o["g"])(t.symbol.size);case"esriPMS":return Object(o["g"])(Math.max(t.symbol.width,t.symbol.height));case"esriTS":{const e=[0,0,0,0];W(e,t.symbol,t.mosaicItem);const n=Math.max(Math.abs(e[0]),Math.abs(e[1]));return Math.max(e[2],e[3])+n}case"expanded-cim":{const e=y["a"].getEnvelope(t.symbol.data);return e.width!==-1/0&&e.height!==-1/0||(e.width=10,e.height=10,e.x=0,e.y=0),Object(o["g"])(Math.sqrt(e.width*e.width+e.height*e.height))}case"composite-symbol":{if(!t.symbol.layers.length)return 0;const e=t.symbol.layers.length-1;return P({symbol:t.symbol.layers[e],mosaicItem:null})}case"label":default:return 0}}function W(t,e,n){if(!n||0===n.glyphMosaicItems.length)return t;const r=Object(g["a"])(e.text)[1],i=n.glyphMosaicItems,s=Object(m["a"])(i,r,{scale:Object(o["g"])(e.font.size)/24,angle:e.angle,xOffset:e.xoffset,yOffset:e.yoffset,hAlign:Object(p["d"])(e.horizontalAlignment||"center"),vAlign:Object(p["f"])(e.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(e.lineWidth||512,512)),lineHeight:30*Math.max(.25,Math.min(e.lineHeight||1,4)),decoration:e.font.decoration||"none",isCIM:!1}).bounds;return t[0]=Object(o["g"])(s.x-s.halfWidth),t[1]=Object(o["g"])(s.y-s.halfHeight),t[2]=Object(o["g"])(s.width),t[3]=Object(o["g"])(s.height),t}function D(t,e,n,r,s,a,o,l){let c;switch(r.type){case"esriSMS":case"esriPMS":c=N(e,n,r,a,o,0);break;case"esriTS":c=k(e,n,r,s,a,0);break;case"cim":case"CIMSymbolReference":case"expanded-cim":c=U(e,n,r,a,o,0)}let f,h,d=0;for(let i=0;i<c.rings[0].length-1;i++)h=c.rings[0][i],f=(e-h[0])*(e-h[0])+(n-h[1])*(n-h[1]),d=Math.max(d,f);d=Math.sqrt(d);let b=Object(u["b"])(e-d,l),p=Object(u["b"])(e+d,l);if(b>p){const t=Object(i["d"])(l);if(t){const[e,n]=t.valid;b=e,p=n}}return t[0]=b,t[1]=n-d,t[2]=p,t[3]=n+d,t}},"45a5":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("fa8a");const i=new r["a"]({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function s(t){return i.toJSON(t)}},"6f36":function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return u}));var r=n("a915"),i=n("8c81"),s=n("0eee"),a=n("793f"),o=n("334f");const l={"simple-marker":1,"picture-marker":1,text:0,"simple-line":0,"simple-fill":0,"picture-fill":0,cim:1,"web-style":1},c=.707;function u(t){if(!("visualVariables"in t))return 0;if(!t.hasVisualVariables("size"))return 0;const e=t.getVisualVariablesForType("size");if(!e[0])return 0;const n=e[0];if("stops"===n.transformationType)return n.stops.map(t=>t.size).reduce(j,0);if("clamped-linear"===n.transformationType){let t=-1/0,e=-1/0;return t="number"==typeof n.maxSize?n.maxSize:n.maxSize.stops.map(t=>t.size).reduce(j,0),e="number"==typeof n.minSize?n.minSize:n.minSize.stops.map(t=>t.size).reduce(j,0),Math.max(t,e)}return"real-world-size"===n.transformationType?30:void 0}function f(t){return t.type in l}async function h(t,e,n){if(!t||n&&"cluster"===n.type)return 0;if("heatmap"===t.type)return Math.round(3*t.blurRadius);if("dot-density"===t.type)return 0;if("dictionary"===t.type)return"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?100:200;const i=t.getSymbols(),s=u(t),a=[];for(const r of i)a.push(x(r,s));const o=await Promise.all(a);return Object(r["g"])(o.reduce(j,0))}const d=[0,0,0,0];function b(t,e){return null==t?e:t}function p(t,e){return null==t.outline?e:b(t.outline.width,e)}const m={sdf:!0,code:99,metrics:i["c"].metrics,rect:new s["a"](0,0,24,24),page:0,textureBinding:2};function g(t){const e=t.text&&t.text.length;if(!e)return{glyphMosaicItems:[m]};const n=[];for(let r=0;r<e;r++)n.push({...m,code:t.text.charCodeAt(r)});return{glyphMosaicItems:n}}async function y(t,e){if("simple-marker"===t.type){const n=Math.max(b(t.size,12),e);return O(t)+n*c}if("picture-marker"===t.type){const n=Math.max(b(t.height,12),e),r=b(t.width,12)*(n/b(t.height,12))/2,i=n/2;return O(t)+Math.sqrt(r*r+i*i)}if("text"===t.type){const e=g(t);Object(o["g"])(d,t.toJSON(),e);const n=Math.abs(d[0]),r=Math.abs(d[1]),i=d[2],s=d[3];return Math.max(n,r)+Math.max(i,s)}if("simple-line"===t.type){const n=t,r=Math.max(b(n.width,.75),e)/2;return n.marker?Math.max(6*n.width,2*e):r}if("simple-fill"===t.type||"picture-fill"===t.type)return Math.max(p(t,0),e)/2;if("cim"===t.type){const e=a["a"].getEnvelope(t.data);return e?Math.sqrt(e.width*e.width+e.height*e.height):0}return"web-style"===t.type?y(await t.fetchCIMSymbol(),e):0}async function x(t,e){return f(t)?Math.min(await y(t,e),75):0}function O(t){const e=b(t.xoffset,0),n=b(t.yoffset,0);return Math.sqrt(e*e+n*n)}function j(t,e){return Math.max(t,e)}},"7efa":function(t,e,n){"use strict";n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return r}));const r={Base64:0,Hex:1,String:2,Raw:3},i=8,s=(1<<i)-1;function a(t,e){const n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function o(t){const e=[];for(let n=0,r=t.length*i;n<r;n+=i)e[n>>5]|=(t.charCodeAt(n/i)&s)<<n%32;return e}function l(t){const e=[];for(let n=0,r=32*t.length;n<r;n+=i)e.push(String.fromCharCode(t[n>>5]>>>n%32&s));return e.join("")}function c(t){const e="0123456789abcdef",n=[];for(let r=0,i=4*t.length;r<i;r++)n.push(e.charAt(t[r>>2]>>r%4*8+4&15)+e.charAt(t[r>>2]>>r%4*8&15));return n.join("")}function u(t){const e="=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[];for(let i=0,s=4*t.length;i<s;i+=3){const s=(t[i>>2]>>i%4*8&255)<<16|(t[i+1>>2]>>(i+1)%4*8&255)<<8|t[i+2>>2]>>(i+2)%4*8&255;for(let a=0;a<4;a++)8*i+6*a>32*t.length?r.push(e):r.push(n.charAt(s>>6*(3-a)&63))}return r.join("")}function f(t,e){return t<<e|t>>>32-e}function h(t,e,n,r,i,s){return a(f(a(a(e,t),a(r,s)),i),n)}function d(t,e,n,r,i,s,a){return h(e&n|~e&r,t,e,i,s,a)}function b(t,e,n,r,i,s,a){return h(e&r|n&~r,t,e,i,s,a)}function p(t,e,n,r,i,s,a){return h(e^n^r,t,e,i,s,a)}function m(t,e,n,r,i,s,a){return h(n^(e|~r),t,e,i,s,a)}function g(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(let o=0;o<t.length;o+=16){const e=n,l=r,c=i,u=s;n=d(n,r,i,s,t[o+0],7,-680876936),s=d(s,n,r,i,t[o+1],12,-389564586),i=d(i,s,n,r,t[o+2],17,606105819),r=d(r,i,s,n,t[o+3],22,-1044525330),n=d(n,r,i,s,t[o+4],7,-176418897),s=d(s,n,r,i,t[o+5],12,1200080426),i=d(i,s,n,r,t[o+6],17,-1473231341),r=d(r,i,s,n,t[o+7],22,-45705983),n=d(n,r,i,s,t[o+8],7,1770035416),s=d(s,n,r,i,t[o+9],12,-1958414417),i=d(i,s,n,r,t[o+10],17,-42063),r=d(r,i,s,n,t[o+11],22,-1990404162),n=d(n,r,i,s,t[o+12],7,1804603682),s=d(s,n,r,i,t[o+13],12,-40341101),i=d(i,s,n,r,t[o+14],17,-1502002290),r=d(r,i,s,n,t[o+15],22,1236535329),n=b(n,r,i,s,t[o+1],5,-165796510),s=b(s,n,r,i,t[o+6],9,-1069501632),i=b(i,s,n,r,t[o+11],14,643717713),r=b(r,i,s,n,t[o+0],20,-373897302),n=b(n,r,i,s,t[o+5],5,-701558691),s=b(s,n,r,i,t[o+10],9,38016083),i=b(i,s,n,r,t[o+15],14,-660478335),r=b(r,i,s,n,t[o+4],20,-405537848),n=b(n,r,i,s,t[o+9],5,568446438),s=b(s,n,r,i,t[o+14],9,-1019803690),i=b(i,s,n,r,t[o+3],14,-187363961),r=b(r,i,s,n,t[o+8],20,1163531501),n=b(n,r,i,s,t[o+13],5,-1444681467),s=b(s,n,r,i,t[o+2],9,-51403784),i=b(i,s,n,r,t[o+7],14,1735328473),r=b(r,i,s,n,t[o+12],20,-1926607734),n=p(n,r,i,s,t[o+5],4,-378558),s=p(s,n,r,i,t[o+8],11,-2022574463),i=p(i,s,n,r,t[o+11],16,1839030562),r=p(r,i,s,n,t[o+14],23,-35309556),n=p(n,r,i,s,t[o+1],4,-1530992060),s=p(s,n,r,i,t[o+4],11,1272893353),i=p(i,s,n,r,t[o+7],16,-155497632),r=p(r,i,s,n,t[o+10],23,-1094730640),n=p(n,r,i,s,t[o+13],4,681279174),s=p(s,n,r,i,t[o+0],11,-358537222),i=p(i,s,n,r,t[o+3],16,-722521979),r=p(r,i,s,n,t[o+6],23,76029189),n=p(n,r,i,s,t[o+9],4,-640364487),s=p(s,n,r,i,t[o+12],11,-421815835),i=p(i,s,n,r,t[o+15],16,530742520),r=p(r,i,s,n,t[o+2],23,-995338651),n=m(n,r,i,s,t[o+0],6,-198630844),s=m(s,n,r,i,t[o+7],10,1126891415),i=m(i,s,n,r,t[o+14],15,-1416354905),r=m(r,i,s,n,t[o+5],21,-57434055),n=m(n,r,i,s,t[o+12],6,1700485571),s=m(s,n,r,i,t[o+3],10,-1894986606),i=m(i,s,n,r,t[o+10],15,-1051523),r=m(r,i,s,n,t[o+1],21,-2054922799),n=m(n,r,i,s,t[o+8],6,1873313359),s=m(s,n,r,i,t[o+15],10,-30611744),i=m(i,s,n,r,t[o+6],15,-1560198380),r=m(r,i,s,n,t[o+13],21,1309151649),n=m(n,r,i,s,t[o+4],6,-145523070),s=m(s,n,r,i,t[o+11],10,-1120210379),i=m(i,s,n,r,t[o+2],15,718787259),r=m(r,i,s,n,t[o+9],21,-343485551),n=a(n,e),r=a(r,l),i=a(i,c),s=a(s,u)}return[n,r,i,s]}function y(t,e=r.Hex){const n=e||r.Base64,s=g(o(t),t.length*i);switch(n){case r.Raw:return s;case r.Hex:return c(s);case r.String:return l(s);case r.Base64:return u(s)}}},"9bae":function(t,e,n){"use strict";n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return j})),n.d(e,"d",(function(){return T}));var r,i=n("c120"),s=n("b2b2"),a=n("e92d"),o=n("ce50"),l=n("9a81"),c=n("c3fc"),u=n("7efa"),f=n("a4ee"),h=n("7ffa"),d=(n("cea0"),n("59b2")),b=n("d386"),p=n("09db"),m=(n("e041"),n("8eed"),n("f402"),n("86f2"));let g=r=class extends c["a"]{writeLevels(t,e,n){for(const r in t){const t=this.levels[r];return void(e.stops=t)}}clone(){return new r({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Object(m["c"])(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Object(m["c"])(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(t=>t.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:Object(h["a"])(this.levels)})}};Object(f["a"])([Object(d["b"])()],g.prototype,"levels",void 0),Object(f["a"])([Object(p["a"])("levels")],g.prototype,"writeLevels",null),g=r=Object(f["a"])([Object(b["a"])("esri.views.2d.engine.LevelDependentSizeVariable")],g);const y=a["a"].getLogger("esri.views.2d.layers.support.clusterUtils");i["a"].add("esri-cluster-arcade-enabled",1);const x=Object(i["a"])("esri-cluster-arcade-enabled"),O=(t,e,n,r)=>{const i=e.clone();if(!T(i))return i;if(n.fields)for(const s of n.fields)_(t,s);if("visualVariables"in i){const e=(i.visualVariables||[]).filter(t=>"$view.scale"!==t.valueExpression),a=j(e);e.forEach(e=>{"rotation"===e.type?e.field?e.field=M(t,e.field,"avg_angle"):e.valueExpression&&(e.field=L(t,e.valueExpression,"avg_angle"),e.valueExpression=null):e.normalizationField?(e.field=M(t,e.field,"norm",e.normalizationField),e.normalizationField=null):e.field?e.field=M(t,e.field,"avg"):(e.field=L(t,e.valueExpression,"avg"),e.valueExpression=null)}),Object(s["j"])(a)&&!v(e)&&(e.push(w(n,r)),i.dynamicClusterSize=!0),i.visualVariables=e}switch(i.type){case"simple":break;case"unique-value":i.field?i.field=M(t,i.field,"mode"):i.valueExpression&&(i.field=L(t,i.valueExpression,"mode"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=M(t,i.field,"norm",i.normalizationField),i.normalizationField=null):i.field?i.field=M(t,i.field,"avg"):(i.field=L(t,i.valueExpression,"avg"),i.valueExpression=null)}return i},j=t=>{for(const e of t)if("size"===e.type)return e;return null},v=t=>{for(const e of t)if("cluster_count"===e.field)return!0;return!1},w=(t,e)=>{const n=[new l["a"]({value:0,size:0}),new l["a"]({value:1})];if(Object(s["j"])(e))return new c["a"]({field:"cluster_count",stops:[...n,new l["a"]({value:2,size:0})]});const r=Object.keys(e).reduce((r,i)=>({...r,[i]:[...n,new l["a"]({value:Math.max(2,e[i].minValue),size:t.clusterMinSize}),new l["a"]({value:Math.max(3,e[i].maxValue),size:t.clusterMaxSize})]}),{});return new g({field:"cluster_count",levels:r})},T=t=>{const e=e=>y.error(new o["a"]("Unsupported-renderer",e,{renderer:t}));if("unique-value"===t.type){if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===t.type){if(t.normalizationField){const n=t.normalizationType;if("field"!==n)return e("FeatureReductionCluster does not support a normalizationType of "+n),!1}}else if("simple"!==t.type)return e("FeatureReductionCluster does not support renderers of type "+t.type),!1;if(!x){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(t=>!(!("valueExpression"in t)||!t.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function S(t,e,n){switch(t){case"avg":case"avg_angle":return"cluster_avg_"+e;case"mode":return"cluster_type_"+e;case"norm":{const t=n,r="field",i=e.toLowerCase()+",norm:"+r+","+t.toLowerCase();return"cluster_avg_"+Object(u["a"])(i)}}}function _(t,e){const{name:n,outStatistic:r}=e,{onStatisticField:i,onStatisticValueExpression:s,statisticType:a}=r;if(s){const e=Object(u["a"])(s.toLowerCase());t.push({name:n,outStatistic:{onStatisticField:e,onStatisticValueExpression:s,statisticType:a}})}else i?t.push({name:n,outStatistic:{onStatisticField:i,statisticType:a}}):y.error(new o["a"]("mapview-unsupported-field","Unable to handle field",{field:e}))}function L(t,e,n){const r=Object(u["a"])(e),i="mode"===n?"cluster_type_"+r:"cluster_avg_"+r;return t.some(t=>t.name===i)||t.push({name:i,outStatistic:{onStatisticField:r,onStatisticValueExpression:e,statisticType:n}}),i}function M(t,e,n,r){if("cluster_count"===e||t.some(t=>t.name===e))return e;const i=S(n,e,r);return t.some(t=>t.name===i)||("norm"===n?t.push({name:i,outStatistic:{onStatisticField:e,onStatisticNormalizationField:r,statisticType:n}}):t.push({name:i,outStatistic:{onStatisticField:e,statisticType:n}})),i}},a305:function(t,e,n){"use strict";n.d(e,"a",(function(){return $})),n.d(e,"b",(function(){return E})),n.d(e,"c",(function(){return _}));var r=n("c120"),i=n("7ffa"),s=n("b2b2"),a=n("e92d"),o=n("ce50"),l=n("a915"),c=(n("667b"),n("6174")),u=(n("b423"),n("da00"),n("261a"),n("b48d"),n("478c"),n("ff57")),f=(n("f976"),n("9bae")),h=n("c84e"),d=n("18c6"),b=n("c8dd"),p=n("3484");function m(t){if(!t)return h["e"].NONE;let e=0;for(const n of t)if("size"===n.type){const t=Object(p["a"])(n);e|=t,"outline"===n.target&&(e|=t<<4)}else"color"===n.type?e|=h["e"].COLOR:"opacity"===n.type?e|=h["e"].OPACITY:"rotation"===n.type&&(e|=h["e"].ROTATION);return e}var g=n("6f36"),y=n("b433"),x=n("45a5");const O=a["a"].getLogger("esri.views.2d.layers.features.schemaUtils"),j="ValidationError",v={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function w(t){return Object(d["h"])(t)}function T(t){return t}function S(t){switch(t.type){case"line-marker":var e;return{type:"line-marker",color:null==(e=t.color)?void 0:e.toJSON(),placement:t.placement,style:t.style};default:return Object(c["a"])(t.toJSON()).toJSON()}}function _(t,e,n){if(!t)return null;let r=0,i=!1,a=0;switch(Object(s["k"])(e)&&(a=Object(g["b"])(e),"visualVariables"in e&&(r=m(e.visualVariables||[]),i="dot-density"===e.type)),t.type){case"simple-fill":case"picture-fill":return L(t,r,i,n);case"simple-marker":case"picture-marker":return F(t,r,a,n);case"simple-line":return M(t,r,n);case"text":return A(t,r,a,n);case"label":return z(t,r,n);case"cim":return{type:"cim",rendererKey:r,data:t.data,maxVVSize:a};case"web-style":return{...S(t),type:"web-style",hash:t.hash(),rendererKey:r,maxVVSize:a};default:throw new Error("symbol not supported "+t.type)}}function L(t,e,n,r){const i=Object(d["g"])(h["d"].FILL,e,!1,n),s=r?w(i):i,a=t.clone(),o=a.outline;a.outline=null;const l=[],c={materialKey:s,hash:a.hash(),...S(a)};if(l.push(c),o){const t=Object(d["g"])(h["d"].LINE,e,!0,!1),n={materialKey:r?w(t):t,hash:o.hash(),...S(o)};l.push(n)}return{type:"composite-symbol",layers:l,hash:l.reduce((t,e)=>e.hash+t,"")}}function M(t,e,n){const r=Object(d["g"])(h["d"].LINE,e,!1,!1),i=n?w(r):r,s=t.clone(),a=s.marker;s.marker=null;const o=[];if(o.push({materialKey:i,hash:s.hash(),...S(s)}),a){var l;const t=Object(d["g"])(h["d"].MARKER,e,!1,!1),r=n?w(t):t;a.color=null!=(l=a.color)?l:s.color,o.push({materialKey:r,hash:a.hash(),lineWidth:s.width,...S(a)})}return{type:"composite-symbol",layers:o,hash:o.reduce((t,e)=>e.hash+t,"")}}function F(t,e,n,r){const i=Object(d["g"])(h["d"].MARKER,e,!1,!1),s=r?w(i):i,a=S(t);return{materialKey:s,hash:t.hash(),...a,angle:t.angle,maxVVSize:n}}function A(t,e,n,r){const i=Object(d["g"])(h["d"].TEXT,e,!1,!1),s=r?w(i):i,a=S(t);return{materialKey:s,hash:t.hash(),...a,angle:t.angle,maxVVSize:n}}function R(t,e){const n=t.labelPlacement,r=v[e];if(!t.symbol)return O.warn("No LabelClass symbol specified."),!0;if(!r)return O.error(new o["a"]("mapview-labeling:unsupported-geometry-type",`Unable to create labels for Feature Layer, ${e} is not supported`)),!0;if(!r.some(t=>t===n)){const i=r[0];n&&O.warn(`Found invalid label placement type ${n} for ${e}. Defaulting to ${i}`),t.labelPlacement=i}return!1}function B(t,e){const n=Object(i["a"])(t);return n.some(t=>R(t,e))?[]:n}function z(t,e,n){const r=Object(d["g"])(h["d"].LABEL,e,!1,!1,t.labelPlacement);return{materialKey:n?w(r):r,hash:t.hash(),...t.toJSON(),labelPlacement:t.labelPlacement}}function E(t){return Object(r["a"])("esri-2d-update-debug")&&console.debug("Created new schema",V(t,!0)),V(t)}function V(t,e=!1){try{var n,r;const i=D(t,e),s={};return i.map(e=>C(s,t,e)),{source:{definitionExpression:t.definitionExpression,fields:t.fields.map(t=>t.toJSON()),gdbVersion:t.gdbVersion,historicMoment:null==(n=t.historicMoment)?void 0:n.getTime(),outFields:t.availableFields,pixelBuffer:t.pixelBuffer,spatialReference:t.spatialReference.toJSON(),timeExtent:null==(r=t.timeExtent)?void 0:r.toJSON()},attributes:{fields:{},indexCount:0},processors:i,targets:s}}catch(i){if(i.fieldName===j)return O.error(i),null;throw i}}function C(t,e,n){switch(n.target){case"feature":return void U(t,N(e),n);case"aggregate":{const r=e.featureReduction;if("selection"===r.type)throw new o["a"](j,"Mapview does not support `selection` reduction type",r);return U(t,N(e),n),void k(t,r,n)}}}function I(t,e){for(const n in e){const r=e[n];if(r.target!==t.name)continue;const i=t.attributes[n];i?(i.context.mesh=i.context.mesh||r.context.mesh,i.context.storage=i.context.storage||r.context.storage):t.attributes[n]=r}return t}function N(t){var e,n,r,i,s;return[null!=(e=null==(n=t.filter)?void 0:n.toJSON())?e:null,null!=(r=null==(i=t.effect)||null==(s=i.filter)?void 0:s.toJSON())?r:null]}function U(t,e,n){return t.feature||(t.feature={name:"feature",input:"source",filters:e,attributes:{}}),I(t.feature,n.attributes.fields),t}function k(t,e,n){return t.aggregate||(t.aggregate={name:"aggregate",input:"feature",filters:null,attributes:{},params:{clusterRadius:Object(l["g"])(e.clusterRadius/2),clusterPixelBuffer:64*Math.ceil(Object(l["g"])(e.clusterMaxSize)/64),fields:n.aggregateFields}}),I(t.aggregate,n.attributes.fields),t}function P(t,e){return e.field?W(t,{...e,type:"field",field:e.field}):e.valueExpression?W(t,{...e,type:"expression",valueExpression:e.valueExpression}):{field:null,fieldIndex:null}}function W(t,e){switch(e.type){case"expression":{const n=T(e.valueExpression);if(!t.fields[n]){const r=t.indexCount++;t.fields[n]={...e,name:n,fieldIndex:r}}return{fieldIndex:t.fields[n].fieldIndex}}case"label-expression":{const n=T(JSON.stringify(e.label));if(!t.fields[n]){const r=t.indexCount++;t.fields[n]={...e,name:n,fieldIndex:r}}return{fieldIndex:t.fields[n].fieldIndex}}case"field":{const n=e.field;return"aggregate"===e.target&&t.fields[n]||(t.fields[n]={...e,name:n}),{field:n}}case"statistic":return t.fields[e.name]={...e},{field:e.name}}}function D(t,e=!1){const n=new Array;let r=0;return n.push(J(t,r++,e)),n}function H(t,e,n,r,i,s=!1){const a=W(e,{type:"label-expression",target:r,context:{mesh:!0},resultType:"string",label:{labelExpression:n.labelExpression,labelExpressionInfo:n.labelExpressionInfo?{expression:n.labelExpressionInfo.expression}:null,symbol:!!n.symbol,where:n.where}}),{fieldIndex:o}=a;return{..._(n,t,s),fieldIndex:o,target:r,index:i}}function J(t,e,n=!1){const r={indexCount:0,fields:{}},i="featureReduction"in t&&t.featureReduction,s=i?"aggregate":"feature";switch(t.renderer.type){case"heatmap":{const{blurRadius:e,fieldOffset:n,field:i}=t.renderer;return{type:"heatmap",aggregateFields:[],attributes:r,target:s,storage:null,mesh:{blurRadius:e,fieldOffset:n,field:P(r,{target:s,field:i,resultType:"numeric"}).field}}}default:{const e=[],a="aggregate"===s?Object(f["b"])(e,t.renderer,i,null):t.renderer;q(r,e);const l=$(r,s,a,n);let c=null;const h=G(r,s,a),d=Object(x["a"])(t.geometryType);let b=t.labelsVisible&&t.labelingInfo||[],p=[];if(i){if("selection"===i.type)throw new o["a"](j,"Mapview does not support `selection` reduction type",i);if(i.symbol){const t=new u["a"]({symbol:i.symbol,visualVariables:"visualVariables"in a?a.visualVariables:null});c=$(r,s,t,n)}p=i&&i.labelsVisible&&i.labelingInfo||[]}b=B(b,d),p=B(p,d);let m=0;const g=[...b.map(t=>H(a,r,t,"feature",m++,n)),...p.map(t=>H(a,r,t,"aggregate",m++,n))];return{type:"symbol",target:s,attributes:r,aggregateFields:e,storage:h,mesh:{matcher:l,labels:g,aggregateMatcher:c}}}}}function q(t,e){const n={mesh:!0,storage:!0};for(const r of e){const{name:e,outStatistic:i}=r,{statisticType:s,onStatisticField:a}=i;let o=null,l=null,c=null;const u="numeric",f="feature";"onStatisticValueExpression"in i?l=W(t,{type:"expression",target:f,valueExpression:i.onStatisticValueExpression,resultType:u}).fieldIndex:"onStatisticNormalizationField"in i?(o=W(t,{type:"field",target:f,field:a,resultType:u}).field,c=i.onStatisticNormalizationField):o=W(t,{type:"field",target:f,field:a,resultType:u}).field,W(t,{type:"statistic",target:"aggregate",name:e,context:n,inField:o,inNormalizationField:c,inFieldIndex:l,statisticType:s})}}function G(t,e,n){switch(n.type){case"dot-density":return K(t,e,n.attributes);case"simple":case"class-breaks":case"unique-value":return Y(t,e,n.visualVariables);case"heatmap":case"dictionary":return null}}function K(t,e,n){return n&&n.length?{type:"dot-density",mapping:n.map((n,r)=>{const{field:i,fieldIndex:s}=P(t,{valueExpression:n.valueExpression,field:n.field,resultType:"numeric",target:e});return{binding:r,field:i,fieldIndex:s}}),target:e}:{type:"dot-density",mapping:[],target:e}}function Y(t,e,n){if(!n||!n.length)return{type:"visual-variable",mapping:[],target:e};const r={storage:!0},i="numeric";return{type:"visual-variable",mapping:Object(y["b"])(n).map(n=>{var s;const a=Object(b["m"])(n.type),{field:o,fieldIndex:l}=P(t,{target:e,valueExpression:n.valueExpression,field:n.field,context:r,resultType:i});switch(n.type){case"size":return"$view.scale"===n.valueExpression?null:{type:"size",binding:a,field:o,fieldIndex:l,normalizationField:P(t,{target:e,field:n.normalizationField,context:r,resultType:i}).field,valueRepresentation:null!=(s=n.valueRepresentation)?s:null};case"color":return{type:"color",binding:a,field:o,fieldIndex:l,normalizationField:P(t,{target:e,field:n.normalizationField,context:r,resultType:i}).field};case"opacity":return{type:"opacity",binding:a,field:o,fieldIndex:l,normalizationField:P(t,{target:e,field:n.normalizationField,context:r,resultType:i}).field};case"rotation":return{type:"rotation",binding:a,field:o,fieldIndex:l}}}).filter(t=>t),target:e}}function $(t,e,n,r=!1){const i=Object(s["r"])(t,{indexCount:0,fields:{}});switch(n.type){case"simple":case"dot-density":return X(i,n,"dot-density"===n.type,r);case"class-breaks":return Z(i,e,n,r);case"unique-value":return Q(i,e,n,r);case"dictionary":return tt(i,n,r)}}function X(t,e,n,r=!1){const i=e.getSymbols();return{type:"simple",symbol:_(i.length?i[0]:null,e,r),isDotDensity:n}}function Z(t,e,n,r=!1){const i={mesh:!0,use:"renderer.field"},s=n.backgroundFillSymbol,{field:a,fieldIndex:o}=P(t,{target:e,field:n.field,valueExpression:n.valueExpression,resultType:"numeric",context:i}),l=n.normalizationType,c="log"===l?"esriNormalizeByLog":"percent-of-total"===l?"esriNormalizeByPercentOfTotal":"field"===l?"esriNormalizeByField":null,u=n.classBreakInfos.map(t=>({symbol:_(t.symbol,n,r),min:t.minValue,max:t.maxValue})).sort((t,e)=>t.min-e.min);return{type:"interval",attributes:t.fields,field:a,fieldIndex:o,backgroundFillSymbol:_(s,n,r),defaultSymbol:_(n.defaultSymbol,n,r),intervals:u,normalizationField:n.normalizationField,normalizationTotal:n.normalizationTotal,normalizationType:c,isMaxInclusive:n.isMaxInclusive}}function Q(t,e,n,r=!1){const i=[],s=n.backgroundFillSymbol,a={target:e,context:{mesh:!0},resultType:"string"};if(n.field&&"string"!=typeof n.field)throw new o["a"](j,"Expected renderer.field to be a string",n);const{field:l,fieldIndex:c}=P(t,{...a,field:n.field,valueExpression:n.valueExpression});for(const o of n.uniqueValueInfos)i.push({value:""+o.value,symbol:_(o.symbol,n,r)});return{type:"map",attributes:t.fields,field:l,fieldIndex:c,field2:P(t,{...a,field:n.field2}).field,field3:P(t,{...a,field:n.field3}).field,fieldDelimiter:n.fieldDelimiter,backgroundFillSymbol:_(s,n),defaultSymbol:_(n.defaultSymbol,n),map:i}}function tt(t,e,n=!1){return{type:"dictionary",renderer:e.toJSON()}}},a9c0:function(t,e,n){"use strict";class r{constructor(t=0,e=0,n=0,r=0){this.x=t,this.y=e,this.width=n,this.height=r}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}e["a"]=r},b433:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return c}));var r=n("e92d"),i=n("a915");const s=8,a=s-2,o=r["a"].getLogger("esri.renderers.visualVariables.support.utils"),l=t=>{if(!("visualVariables"in t)||!t.visualVariables||!t.visualVariables.length)return t;const e=t.clone(),n=e.visualVariables.map(t=>u(t)?f(t):t);return e.visualVariables=n,e};function c(t){return t.map(t=>u(t)?f(t.clone()):t)}function u(t){return("size"===t.type||"color"===t.type||"opacity"===t.type)&&null!=t.stops}function f(t){return t.stops=p(t.type,t.stops),t}function h(t,e,n){return(1-n)*t+n*e}function d(t,e){const[n,...r]=e,s=r.pop(),o=r[0].value,l=r[r.length-1].value,c=(l-o)/a,u=[];for(let a=o;a<l;a+=c){let n=0;for(;a>=r[n].value;)n++;const s=r[n],o=e[n-1],l=a-o.value,c=s.value===o.value?1:l/(s.value-o.value);if("color"===t){const t=r[n],i=e[n-1],s=t.color.clone();s.r=h(i.color.r,s.r,c),s.g=h(i.color.g,s.g,c),s.b=h(i.color.b,s.b,c),s.a=h(i.color.a,s.a,c),u.push({value:a,color:s,label:t.label})}else if("size"===t){const t=r[n],s=e[n-1],o=Object(i["j"])(t.size),l=h(Object(i["j"])(s.size),o,c);u.push({value:a,size:l,label:t.label})}else{const t=r[n],i=h(e[n-1].opacity,t.opacity,c);u.push({value:a,opacity:i,label:t.label})}}return[n,...u,s]}function b(t){const[e,...n]=t,r=n.pop();for(;n.length>a;){let t=0,e=0;for(let r=1;r<n.length;r++){const i=n[r-1],s=n[r],a=Math.abs(s.value-i.value);a>e&&(e=a,t=r)}n.splice(t,1)}return[e,...n,r]}function p(t,e){return e.length<=s?e:(o.warn(`Found ${e.length} Visual Variable stops, but MapView only supports ${s}. Displayed stops will be simplified.`),e.length>2*s?d(t,e):b(e))}},b7b9:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("d7bf");const i=new r["a"];function s(t){if(!i.hasBidiChar(t))return[t,!1];let e;return e="rtl"===i.checkContextual(t)?"IDNNN":"ICNNN",[i.bidiTransform(t,e,"VLYSN"),!0]}},d7bf:function(t,e,n){"use strict";const r=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["«","»"],["»","«"],["‹","›"],["›","‹"],["⁽","⁾"],["⁾","⁽"],["₍","₎"],["₎","₍"],["≤","≥"],["≥","≤"],["〈","〉"],["〉","〈"],["﹙","﹚"],["﹚","﹙"],["﹛","﹜"],["﹜","﹛"],["﹝","﹞"],["﹞","﹝"],["﹤","﹥"],["﹥","﹤"]],i=["آ","أ","إ","ا"],s=["ﻵ","ﻷ","ﻹ","ﻻ"],a=["ﻶ","ﻸ","ﻺ","ﻼ"],o=["ا","ب","ت","ث","ج","ح","خ","د","ذ","ر","ز","س","ش","ص","ض","ط","ظ","ع","غ","ف","ق","ك","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ل","م","ن","ه","و","ي","إ","أ","آ","ة","ى","ی","ئ","ؤ"],l=["ﺍ","ﺏ","ﺕ","ﺙ","ﺝ","ﺡ","ﺥ","ﺩ","ﺫ","ﺭ","ﺯ","ﺱ","ﺵ","ﺹ","ﺽ","ﻁ","ﻅ","ﻉ","ﻍ","ﻑ","ﻕ","ﻙ","ﻝ","ﻡ","ﻥ","ﻩ","ﻭ","ﻱ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯼ","ﺉ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺉ","ﺅ"],c=["ﺎ","ﺐ","ﺖ","ﺚ","ﺞ","ﺢ","ﺦ","ﺪ","ﺬ","ﺮ","ﺰ","ﺲ","ﺶ","ﺺ","ﺾ","ﻂ","ﻆ","ﻊ","ﻎ","ﻒ","ﻖ","ﻚ","ﻞ","ﻢ","ﻦ","ﻪ","ﻮ","ﻲ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯽ","ﺊ","ﺆ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺊ","ﺆ"],u=["ﺎ","ﺒ","ﺘ","ﺜ","ﺠ","ﺤ","ﺨ","ﺪ","ﺬ","ﺮ","ﺰ","ﺴ","ﺸ","ﺼ","ﻀ","ﻄ","ﻈ","ﻌ","ﻐ","ﻔ","ﻘ","ﻜ","ﻠ","ﻤ","ﻨ","ﻬ","ﻮ","ﻴ","ﺈ","ﺄ","ﺂ","ﺔ","ﻰ","ﯿ","ﺌ","ﺆ","ﹱ","ﹲ","ﹴ","ﹷ","ﹹ","ﹻ","ﹽ","ﹿ","ﺀ","ﺌ","ﺆ"],f=["ﺍ","ﺑ","ﺗ","ﺛ","ﺟ","ﺣ","ﺧ","ﺩ","ﺫ","ﺭ","ﺯ","ﺳ","ﺷ","ﺻ","ﺿ","ﻃ","ﻇ","ﻋ","ﻏ","ﻓ","ﻗ","ﻛ","ﻟ","ﻣ","ﻧ","ﻫ","ﻭ","ﻳ","ﺇ","ﺃ","ﺁ","ﺓ","ﻯ","ﯾ","ﺋ","ﺅ","ﹰ","ﹲ","ﹴ","ﹶ","ﹸ","ﹺ","ﹼ","ﹾ","ﺀ","ﺋ","ﺅ"],h=["ء","آ","أ","ؤ","إ","ا","ة","د","ذ","ر","ز","و","ى"],d=["ً","ً","ٌ","؟","ٍ","؟","َ","َ","ُ","ُ","ِ","ِ","ّ","ّ","ْ","ْ","ء","آ","آ","أ","أ","ؤ","ؤ","إ","إ","ئ","ئ","ئ","ئ","ا","ا","ب","ب","ب","ب","ة","ة","ت","ت","ت","ت","ث","ث","ث","ث","ج","ج","ج","ج","ح","ح","ح","ح","خ","خ","خ","خ","د","د","ذ","ذ","ر","ر","ز","ز","س","س","س","س","ش","ش","ش","ش","ص","ص","ص","ص","ض","ض","ض","ض","ط","ط","ط","ط","ظ","ظ","ظ","ظ","ع","ع","ع","ع","غ","غ","غ","غ","ف","ف","ف","ف","ق","ق","ق","ق","ك","ك","ك","ك","ل","ل","ل","ل","م","م","م","م","ن","ن","ن","ن","ه","ه","ه","ه","و","و","ى","ى","ي","ي","ي","ي","ﻵ","ﻶ","ﻷ","ﻸ","ﻹ","ﻺ","ﻻ","ﻼ","؟","؟","؟"],b=["ء","ف"],p=["غ","ي"],m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y=0,x=1,O=2,j=3,v=4,w=5,T=6,S=7,_=8,L=9,M=10,F=11,A=12,R=13,B=14,z=15,E=16,V=17,C=18,I=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],N=100,U=[N+0,y,y,y,y,N+1,N+2,N+3,x,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,N+4,v,v,v,y,v,y,v,y,v,v,v,y,y,v,v,y,y,y,y,y,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,y,y,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,y,y,v,v,y,y,v,v,y,y,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,y,y,y,N+5,S,S,N+6,N+7],k=[[C,C,C,C,C,C,C,C,C,T,w,T,_,w,C,C,C,C,C,C,C,C,C,C,C,C,C,C,w,w,w,T,_,v,v,F,F,F,v,v,v,v,v,M,L,M,L,L,O,O,O,O,O,O,O,O,O,O,L,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,C,C,C,C,C,C,w,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,C,L,v,F,F,F,F,v,v,v,v,y,v,v,C,v,v,F,F,O,O,v,y,v,v,v,O,y,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,y,y,y,y,y,y,y,y],[y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,y,y,y,y,y,y,y,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,y,v,v,v,v,v,v,v,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,x,A,x,A,A,x,A,A,x,A,v,v,v,v,v,v,v,v,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,v,v,v,v,v,x,x,x,x,x,v,v,v,v,v,v,v,v,v,v,v],[j,j,j,j,v,v,v,v,S,F,F,S,L,S,v,v,A,A,A,A,A,A,A,A,A,A,A,S,v,v,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,j,j,j,j,j,j,j,j,j,j,F,j,j,S,S,S,A,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,A,A,A,A,A,A,A,j,v,A,A,A,A,A,A,S,S,A,A,v,A,A,A,A,S,S,O,O,O,O,O,O,O,O,O,O,S,S,S,S,S,S],[S,S,S,S,S,S,S,S,S,S,S,S,S,S,v,S,S,A,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,v,v,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,A,A,A,A,A,A,A,A,A,A,A,S,v,v,v,v,v,v,v,v,v,v,v,v,v,v,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,A,A,A,A,A,A,A,A,A,x,x,v,v,v,v,x,v,v,v,v,v],[_,_,_,_,_,_,_,_,_,_,_,C,C,C,y,x,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,_,w,R,B,z,E,V,L,F,F,F,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,L,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,_,C,C,C,C,C,v,v,v,v,v,C,C,C,C,C,C,O,y,v,v,O,O,O,O,O,O,M,M,v,v,v,y,O,O,O,O,O,O,O,O,O,O,M,M,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v],[y,y,y,y,y,y,y,v,v,v,v,v,v,v,v,v,v,v,v,y,y,y,y,y,v,v,v,v,v,x,A,x,x,x,x,x,x,x,x,x,x,M,x,x,x,x,x,x,x,x,x,x,x,x,x,v,x,x,x,x,x,v,x,v,x,x,v,x,x,v,x,x,x,x,x,x,x,x,x,x,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S],[A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,A,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,A,A,A,A,A,A,A,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,L,v,L,v,v,L,v,v,v,v,v,v,v,v,v,F,v,v,M,M,v,v,v,v,v,F,F,v,v,v,v,v,S,S,S,S,S,v,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,v,v,C],[v,v,v,F,F,F,v,v,v,v,v,M,L,M,L,L,O,O,O,O,O,O,O,O,O,O,L,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,v,v,v,v,v,v,v,v,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,v,v,v,y,y,y,y,y,y,v,v,y,y,y,y,y,y,v,v,y,y,y,y,y,y,v,v,y,y,y,v,v,v,F,F,v,v,v,F,F,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v]];class P{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(t,e,n){if(this.sourceToTarget=[],this.targetToSource=[],!t)return"";if(pt(this.sourceToTarget,this.targetToSource,t.length),!this.checkParameters(e,n))return t;e=this.inputFormat,n=this.outputFormat;let r=t;const i=jt,s=ht(e.charAt(1)),a=ht(n.charAt(1)),o=("I"===e.charAt(0)?"L":e.charAt(0))+s,l=("I"===n.charAt(0)?"L":n.charAt(0))+a,c=e.charAt(2)+n.charAt(2);i.defInFormat=o,i.defOutFormat=l,i.defSwap=c;const u=W(t,o,l,c,i);let f=!1;return"R"===n.charAt(1)?f=!0:"C"!==n.charAt(1)&&"D"!==n.charAt(1)||(f="rtl"===this.checkContextual(u)),this.sourceToTarget=yt,this.targetToSource=mt(this.sourceToTarget),xt=this.targetToSource,r=e.charAt(3)===n.charAt(3)?u:"S"===n.charAt(3)?H(f,u,!0):K(u,f,!0),this.sourceToTarget=yt,this.targetToSource=xt,this.levels=Ot,r}_inputFormatSetter(t){if(!_t.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=t}_outputFormatSetter(t){if(!_t.test(t))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=t}checkParameters(t,e){return t?this._inputFormatSetter(t):t=this.inputFormat,e?this._outputFormatSetter(e):e=this.outputFormat,t!==e}checkContextual(t){let e=q(t);if("ltr"!==e&&"rtl"!==e){try{e=document.dir.toLowerCase()}catch(n){}"ltr"!==e&&"rtl"!==e&&(e="ltr")}return e}hasBidiChar(t){return Lt.test(t)}}function W(t,e,n,r,i){const s=D(t,{inFormat:e,outFormat:n,swap:r},i);if(s.inFormat===s.outFormat)return t;e=s.inFormat,n=s.outFormat,r=s.swap;const a=e.substring(0,1),o=e.substring(1,4),l=n.substring(0,1),c=n.substring(1,4);if(i.inFormat=e,i.outFormat=n,i.swap=r,"L"===a&&"VLTR"===n){if("LTR"===o)return i.dir=Tt,Y(t,i);if("RTL"===o)return i.dir=St,Y(t,i)}if("V"===a&&"V"===l)return i.dir="RTL"===o?St:Tt,tt(t,i);if("L"===a&&"VRTL"===n)return"LTR"===o?(i.dir=Tt,t=Y(t,i)):(i.dir=St,t=Y(t,i)),tt(t);if("VLTR"===e&&"LLTR"===n)return i.dir=Tt,Y(t,i);if("V"===a&&"L"===l&&o!==c)return t=tt(t),"RTL"===o?W(t,"LLTR","VLTR",r,i):W(t,"LRTL","VRTL",r,i);if("VRTL"===e&&"LRTL"===n)return W(t,"LRTL","VRTL",r,i);if("L"===a&&"L"===l){const e=i.swap;return i.swap=e.substr(0,1)+"N","RTL"===o?(i.dir=St,t=Y(t,i),i.swap="N"+e.substr(1,2),i.dir=Tt,t=Y(t,i)):(i.dir=Tt,t=Y(t,i),i.swap="N"+e.substr(1,2),t=W(t,"VLTR","LRTL",i.swap,i)),t}return t}function D(t,e,n){if(void 0===e.inFormat&&(e.inFormat=n.defInFormat),void 0===e.outFormat&&(e.outFormat=n.defOutFormat),void 0===e.swap&&(e.swap=n.defSwap),e.inFormat===e.outFormat)return e;const r=e.inFormat.substring(0,1),i=e.outFormat.substring(0,1);let s,a=e.inFormat.substring(1,4),o=e.outFormat.substring(1,4);return"C"===a.charAt(0)&&(s=q(t),a="ltr"===s||"rtl"===s?s.toUpperCase():"L"===e.inFormat.charAt(2)?"LTR":"RTL",e.inFormat=r+a),"C"===o.charAt(0)&&(s=q(t),"rtl"===s?o="RTL":"ltr"===s?(s=G(t),o=s.toUpperCase()):o="L"===e.outFormat.charAt(2)?"LTR":"RTL",e.outFormat=i+o),e}function H(t,e,n){if(0===e.length)return"";void 0===t&&(t=!0),void 0===n&&(n=!0);const r=(e=String(e)).split("");let i=0,s=1,a=r.length;t||(i=r.length-1,s=-1,a=1);const o=J(r,i,s,a,n);let l="";for(let c=0;c<r.length;c++)n&&et(o,o.length,c)>-1?(gt(xt,c,!t,-1),yt.splice(c,1)):l+=r[c];return l}function J(t,e,n,r,i){let o=0;const u=[];let h=0;for(let d=e;d*n<r;d+=n)if(nt(t[d])||ft(t[d])){if("ل"===t[d]&&it(t,d+n,n,r)){t[d]=bt(t[d+n],0===o?s:a),d+=n,dt(t,d,n,r),i&&(u[h]=d,h++),o=0;continue}const e=t[d];1===o?t[d]=rt(t,d+n,n,r)?ct(t[d]):ut(t[d],c):!0===rt(t,d+n,n,r)?t[d]=ut(t[d],f):t[d]=ut(t[d],l),ft(e)||(o=1),!0===lt(e)&&(o=0)}else o=0;return u}function q(t){const e=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(t);return e?e[0]<="z"?"ltr":"rtl":""}function G(t){const e=t.split("");return e.reverse(),q(e.join(""))}function K(t,e,n){if(0===t.length)return"";void 0===n&&(n=!0),void 0===e&&(e=!0);let r="";const s=(t=String(t)).split("");for(let a=0;a<t.length;a++){let o=!1;if(s[a]>="ﹰ"&&s[a]<"\ufeff"){const l=t.charCodeAt(a);s[a]>="ﻵ"&&s[a]<="ﻼ"?(e?(a>0&&n&&" "===s[a-1]?r=r.substring(0,r.length-1)+"ل":(r+="ل",o=!0),r+=i[(l-65269)/2]):(r+=i[(l-65269)/2],r+="ل",a+1<t.length&&n&&" "===s[a+1]?a++:o=!0),o&&(gt(xt,a,!0,1),yt.splice(a,0,yt[a]))):r+=d[l-65136]}else r+=s[a]}return r}function Y(t,e){const n=t.split(""),r=[];return $(n,r,e),Z(n,r,e),st(2,n,r,e),st(1,n,r,e),Ot=r,n.join("")}function $(t,e,n){const r=t.length,i=n.dir?g:m;let s=0,a=-1;const o=[],l=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let c=0;c<r;c++)o[c]=Q(t[c]);for(let c=0;c<r;c++){const r=s,u=at(t,o,l,c,n);l[c]=u,s=i[r][u];const f=240&s;s&=15;const h=i[s][vt];if(e[c]=h,f>0)if(16===f){for(let t=a;t<c;t++)e[t]=1;a=-1}else a=-1;if(i[s][wt])-1===a&&(a=c);else if(a>-1){for(let t=a;t<c;t++)e[t]=h;a=-1}o[c]===w&&(e[c]=0),n.hiLevel|=h}n.hasUbatS&&X(o,e,r,n)}function X(t,e,n,r){for(let i=0;i<n;i++)if(t[i]===T){e[i]=r.dir;for(let n=i-1;n>=0&&t[n]===_;n--)e[n]=r.dir}}function Z(t,e,n){if(0!==n.hiLevel&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let r=0;r<t.length;r++)1===e[r]&&(t[r]=ot(t[r]))}function Q(t){const e=t.charCodeAt(0),n=U[e>>8];return n<N?n:k[n-N][255&e]}function tt(t,e){const n=t.split("");if(e){const t=[];$(n,t,e),Ot=t}return n.reverse(),yt.reverse(),n.join("")}function et(t,e,n){for(let r=0;r<e;r++)if(t[r]===n)return r;return-1}function nt(t){for(let e=0;e<b.length;e++)if(t>=b[e]&&t<=p[e])return!0;return!1}function rt(t,e,n,r){for(;e*n<r&&ft(t[e]);)e+=n;return!!(e*n<r&&nt(t[e]))}function it(t,e,n,r){for(;e*n<r&&ft(t[e]);)e+=n;let s=" ";if(!(e*n<r))return!1;s=t[e];for(let a=0;a<i.length;a++)if(i[a]===s)return!0;return!1}function st(t,e,n,r){if(r.hiLevel<t)return;if(1===t&&r.dir===St&&!r.hasUbatB)return e.reverse(),void yt.reverse();const i=e.length;let s,a,o,l,c,u=0;for(;u<i;){if(n[u]>=t){for(s=u+1;s<i&&n[s]>=t;)s++;for(a=u,o=s-1;a<o;a++,o--)l=e[a],e[a]=e[o],e[o]=l,c=yt[a],yt[a]=yt[o],yt[o]=c;u=s}u++}}function at(t,e,n,r,i){const s=e[r];return{UBAT_L:()=>(i.lastArabic=!1,y),UBAT_R:()=>(i.lastArabic=!1,x),UBAT_ON:()=>v,UBAT_AN:()=>j,UBAT_EN:()=>i.lastArabic?j:O,UBAT_AL:()=>(i.lastArabic=!0,i.hasUbatAl=!0,x),UBAT_WS:()=>v,UBAT_CS:()=>{let t,s;return r<1||r+1>=e.length||(t=n[r-1])!==O&&t!==j||(s=e[r+1])!==O&&s!==j?v:(i.lastArabic&&(s=j),s===t?s:v)},UBAT_ES:()=>(r>0?n[r-1]:w)===O&&r+1<e.length&&e[r+1]===O?O:v,UBAT_ET:()=>{if(r>0&&n[r-1]===O)return O;if(i.lastArabic)return v;let t=r+1;const s=e.length;for(;t<s&&e[t]===F;)t++;return t<s&&e[t]===O?O:v},UBAT_NSM:()=>{if("VLTR"===i.inFormat){const n=e.length;let i=r+1;for(;i<n&&e[i]===A;)i++;if(i<n){const n=t[r].charCodeAt[0],s=n>=1425&&n<=2303||64286===n,a=e[i];if(s&&(a===x||a===S))return x}}return r<1||e[r-1]===w?v:n[r-1]},UBAT_B:()=>(i.lastArabic=!0,i.hasUbatB=!0,i.dir),UBAT_S:()=>(i.hasUbatS=!0,v),UBAT_LRE:()=>(i.lastArabic=!1,v),UBAT_RLE:()=>(i.lastArabic=!1,v),UBAT_LRO:()=>(i.lastArabic=!1,v),UBAT_RLO:()=>(i.lastArabic=!1,v),UBAT_PDF:()=>(i.lastArabic=!1,v),UBAT_BN:()=>v}[I[s]]()}function ot(t){let e,n=0,i=r.length-1;for(;n<=i;)if(e=Math.floor((n+i)/2),t<r[e][0])i=e-1;else{if(!(t>r[e][0]))return r[e][1];n=e+1}return t}function lt(t){for(let e=0;e<h.length;e++)if(h[e]===t)return!0;return!1}function ct(t){for(let e=0;e<o.length;e++)if(t===o[e])return u[e];return t}function ut(t,e){for(let n=0;n<o.length;n++)if(t===o[n])return e[n];return t}function ft(t){return t>="ً"&&t<="ٕ"}function ht(t){return"L"===t?"LTR":"R"===t?"RTL":"C"===t?"CLR":"D"===t?"CRL":""}function dt(t,e,n,r){for(;e*n<r&&ft(t[e]);)e+=n;return e*n<r&&(t[e]=" ",!0)}function bt(t,e){for(let n=0;n<i.length;n++)if(t===i[n])return e[n];return t}function pt(t,e,n){yt=[],Ot=[];for(let r=0;r<n;r++)t[r]=r,e[r]=r,yt[r]=r}function mt(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[t[n]]=n;return e}function gt(t,e,n,r){for(let i=0;i<t.length;i++)(t[i]>e||!n&&t[i]===e)&&(t[i]+=r)}let yt=[],xt=[],Ot=[];const jt={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},vt=5,wt=6,Tt=0,St=1,_t=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,Lt=/[\u0591-\u06ff\ufb1d-\ufefc]/;e["a"]=P}}]);